#!/bin/sh
NAME="mksh"
VERSION="56b"
LICENSE="MIROS"
DESCRIPTION="An enhanced version of the public domain ksh."
MAKEDEPS="libc"

SRC="$NAME"
URL="https://www.mirbsd.org/MirOS/dist/mir/mksh/${NAME}-R${VERSION}.tgz"
INFILE="../mksh.in"

. ${PORTS}/mk/indef.sh

Prepare() {
	__default_prepare
	chmod +x Build.sh
	./Build.sh -r -M
	env srcfile="rlimits.opt"  BUILDSH_RUN_GENOPT=1 ./Build.sh
	env srcfile="sh_flags.opt" BUILDSH_RUN_GENOPT=1 ./Build.sh
}

Build() {
	oldcpp="$CPPFLAGS"
	CPPFLAGS="$oldcpp -include../mk/mksh_config.h"
	( __default_build )
	CPPFLAGS="$oldcpp -include../mk/lksh_config.h"
	( __default_build )
}

$@
