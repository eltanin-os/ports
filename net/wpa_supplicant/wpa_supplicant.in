#!/bin/sh
. ${PORTS}/mk/ingen.sh

srcdir="."
outdir="."

cflags=` cat <<-EOF
	\$cflags
	-Isrc
	-Isrc/utils
	-DLIBNL1_COMPAT
	-DCONFIG_LIBNL20
	-DCONFIG_BACKEND_FILE
	-DCONFIG_PEERKEY
	-DCONFIG_DRIVER_WEXT
	-DCONFIG_WIRELESS_EXTENSION
	-DCONFIG_DRIVER_WIRED
	-DCONFIG_DRIVER_NL80211
	-DEAP_TLS
	-DEAP_PEAP
	-DEAP_TTLS
	-DEAP_MD5
	-DEAP_MSCHAPv2
	-DEAP_GTC
	-DEAP_OTP
	-DEAP_LEAP
	-DCONFIG_WPS
	-DEAP_WSC
	-DCONFIG_WPS_NFC
	-DCONFIG_WPS_OOB
	-DCONFIG_WPS_ER
	-DCONFIG_WPS_UPNP
	-DCONFIG_WPS_REG_DISABLE_OPEN
	-DIEEE8021X_EAPOL
	-DPKCS12_FUNCS
	-DCONFIG_SMARTCARD
	-DEAP_TLS_OPENSSL
	-DCONFIG_SHA256
	-DCONFIG_CTRL_IFACE
	-DCONFIG_CTRL_IFACE_UNIX
	-DCONFIG_SME
EOF
`

binaries=` cat <<-EOF
	wpa_supplicant/wpa_cli
	wpa_supplicant/wpa_passphrase
	wpa_supplicant/wpa_supplicant
EOF
`

wpacliobjs=` cat <<-EOF
	src/common/cli.c
	src/common/wpa_ctrl.c
	src/utils/common.c
	src/utils/edit_simple.c
	src/utils/eloop.c
	src/utils/os_unix.c
	src/utils/wpa_debug.c
	wpa_supplicant/wpa_cli.c
EOF
`

wpapassphraseobjs=` cat <<-EOF
	src/crypto/crypto_openssl.c
	src/crypto/sha1-prf.c
	src/crypto/sha1-tlsprf.c
	src/crypto/sha256-prf.c
	src/crypto/sha256-tlsprf.c
	src/utils/common.c
	src/utils/os_unix.c
	src/utils/wpa_debug.c
	src/utils/wpabuf.c
	wpa_supplicant/wpa_passphrase.c
EOF
`

wpasupplicantobjs=` cat <<-EOF
	src/common/ctrl_iface_common.c
	src/common/hw_features_common.c
	src/common/ieee802_11_common.c
	src/common/wpa_common.c
	src/crypto/crypto_openssl.c
	src/crypto/dh_groups.c
	src/crypto/ms_funcs.c
	src/crypto/random.c
	src/crypto/sha1-prf.c
	src/crypto/sha1-tlsprf.c
	src/crypto/sha256-prf.c
	src/crypto/sha256-tlsprf.c
	src/crypto/tls_openssl.c
	src/crypto/tls_openssl_ocsp.c
	src/drivers/driver_common.c
	src/drivers/driver_nl80211.c
	src/drivers/driver_nl80211_capa.c
	src/drivers/driver_nl80211_event.c
	src/drivers/driver_nl80211_monitor.c
	src/drivers/driver_nl80211_scan.c
	src/drivers/driver_wext.c
	src/drivers/driver_wired.c
	src/drivers/drivers.c
	src/drivers/linux_ioctl.c
	src/drivers/netlink.c
	src/drivers/rfkill.c
	src/eap_common/chap.c
	src/eap_common/eap_common.c
	src/eap_common/eap_peap_common.c
	src/eap_common/eap_wsc_common.c
	src/eap_peer/eap.c
	src/eap_peer/eap_gtc.c
	src/eap_peer/eap_leap.c
	src/eap_peer/eap_md5.c
	src/eap_peer/eap_methods.c
	src/eap_peer/eap_mschapv2.c
	src/eap_peer/eap_otp.c
	src/eap_peer/eap_peap.c
	src/eap_peer/eap_tls.c
	src/eap_peer/eap_tls_common.c
	src/eap_peer/eap_ttls.c
	src/eap_peer/eap_wsc.c
	src/eap_peer/mschapv2.c
	src/eapol_supp/eapol_supp_sm.c
	src/l2_packet/l2_packet_linux.c
	src/rsn_supp/peerkey.c
	src/rsn_supp/pmksa_cache.c
	src/rsn_supp/preauth.c
	src/rsn_supp/wpa.c
	src/rsn_supp/wpa_ie.c
	src/utils/base64.c
	src/utils/common.c
	src/utils/eloop.c
	src/utils/os_unix.c
	src/utils/radiotap.c
	src/utils/uuid.c
	src/utils/wpa_debug.c
	src/utils/wpabuf.c
	src/wps/http_client.c
	src/wps/http_server.c
	src/wps/httpread.c
	src/wps/ndef.c
	src/wps/upnp_xml.c
	src/wps/wps.c
	src/wps/wps_attr_build.c
	src/wps/wps_attr_parse.c
	src/wps/wps_attr_process.c
	src/wps/wps_common.c
	src/wps/wps_dev_attr.c
	src/wps/wps_enrollee.c
	src/wps/wps_er.c
	src/wps/wps_er_ssdp.c
	src/wps/wps_registrar.c
	src/wps/wps_upnp.c
	src/wps/wps_upnp_ap.c
	src/wps/wps_upnp_event.c
	src/wps/wps_upnp_ssdp.c
	src/wps/wps_upnp_web.c
	wpa_supplicant/blacklist.c
	wpa_supplicant/bss.c
	wpa_supplicant/config.c
	wpa_supplicant/config_file.c
	wpa_supplicant/ctrl_iface.c
	wpa_supplicant/ctrl_iface_unix.c
	wpa_supplicant/eap_register.c
	wpa_supplicant/events.c
	wpa_supplicant/main.c
	wpa_supplicant/notify.c
	wpa_supplicant/scan.c
	wpa_supplicant/sme.c
	wpa_supplicant/wmm_ac.c
	wpa_supplicant/wpa_supplicant.c
	wpa_supplicant/wpas_glue.c
	wpa_supplicant/wps_supplicant.c
EOF
`

manpages=` cat <<-EOF
	wpa_supplicant/doc/docbook/wpa_background.8
	wpa_supplicant/doc/docbook/wpa_cli.8
	wpa_supplicant/doc/docbook/wpa_passphrase.8
	wpa_supplicant/doc/docbook/wpa_supplicant.8
	wpa_supplicant/doc/docbook/wpa_supplicant.conf.5
EOF
`

auto
sets ldlibs "-lrt -lnl-tiny -lssl -lcrypto -ldl"
bin wpa_supplicant/wpa_cli        $wpacliobjs
bin wpa_supplicant/wpa_passphrase $wpapassphraseobjs
bin wpa_supplicant/wpa_supplicant $wpasupplicantobjs
mans $manpages
